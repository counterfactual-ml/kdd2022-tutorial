<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Counterfactual Evaluation and Learning for Interactive Systems (KDD2022 Tutorial) | Counterfactual Evaluation and Learning for Interactive Systems (KDD2022 Tutorial)</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Counterfactual Evaluation and Learning for Interactive Systems (KDD2022 Tutorial)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Counterfactual Evaluation and Learning for Interactive Systems (KDD2022 Tutorial)" />
<meta property="og:description" content="Counterfactual Evaluation and Learning for Interactive Systems (KDD2022 Tutorial)" />
<link rel="canonical" href="https://counterfactual-ml.github.io/kdd2022-tutorial/" />
<meta property="og:url" content="https://counterfactual-ml.github.io/kdd2022-tutorial/" />
<meta property="og:site_name" content="Counterfactual Evaluation and Learning for Interactive Systems (KDD2022 Tutorial)" />
<meta property="og:image" content="https://counterfactual-ml.github.io/kdd2022-tutorial/images/logo.png" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://counterfactual-ml.github.io/kdd2022-tutorial/images/logo.png" />
<meta property="twitter:title" content="Counterfactual Evaluation and Learning for Interactive Systems (KDD2022 Tutorial)" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebSite","description":"Counterfactual Evaluation and Learning for Interactive Systems (KDD2022 Tutorial)","headline":"Counterfactual Evaluation and Learning for Interactive Systems (KDD2022 Tutorial)","image":"https://counterfactual-ml.github.io/kdd2022-tutorial/images/logo.png","name":"Counterfactual Evaluation and Learning for Interactive Systems (KDD2022 Tutorial)","url":"https://counterfactual-ml.github.io/kdd2022-tutorial/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/kdd2022-tutorial/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://counterfactual-ml.github.io/kdd2022-tutorial/feed.xml" title="Counterfactual Evaluation and Learning for Interactive Systems (KDD2022 Tutorial)" /><link rel="shortcut icon" type="image/x-icon" href="/kdd2022-tutorial/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/kdd2022-tutorial/">Counterfactual Evaluation and Learning for Interactive Systems (KDD2022 Tutorial)</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/kdd2022-tutorial/about/">About Me</a><a class="page-link" href="/kdd2022-tutorial/search/">Search</a><a class="page-link" href="/kdd2022-tutorial/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="home"><h2 id="schedule"><strong>Schedule</strong></h2>

<h3 id="time">Time</h3>

<p>Sometime between August 14-18, 2022.</p>

<h2 id="abstract"><strong>Abstract</strong></h2>

<p>Counterfactual estimators enable the use of existing log data to estimate how some new target policy would have performed, if it had been used instead of the policy that logged the data. 
We say that those estimators work “off-policy”, since the policy that logged the data is different from the target policy. 
In this way, counterfactual estimators enable <em>Off-policy Evaluation</em> (OPE) akin to an unbiased offline A/B test, as well as learning new decision-making policies through <em>Off-policy Learning</em> (OPL). 
The goal of this tutorial is to summarize <em>Foundations, Implementations, and Recent Advances</em> of OPE and OPL (OPE/OPL), with applications in recommendation, search, and an ever growing range of interactive systems. 
Specifically, we will introduce the fundamentals of OPE/OPL and provide theoretical and empirical comparisons of conventional methods. 
Then, we will cover emerging practical challenges such as how to handle large action spaces, distributional shift, and hyper-parameter tuning. 
We will then present <a href="https://github.com/st-tech/zr-obp">Open Bandit Pipeline</a>, an open-source Python software for OPE/OPL to better enable new research and applications. 
We will conclude the tutorial with future directions and an interactive QA session.</p>

<p>The learning outcomes of this tutorial are to enable the participants (such as applied researchers, practitioners, and students):</p>

<ul>
  <li>to know fundamental concepts and conventional methods of OPE/OPL</li>
  <li>to be familiar with recent advances to address practical challenges such as large action spaces and hyper-parameter tuning</li>
  <li>to understand how to implement OPE/OPL in their research and applications</li>
  <li>to be aware of remaining challenges and opportunities in the relevant field</li>
</ul>

<p>Note that all materials, including slides and demo code, will be available during and after the tutorial on this tutorial website.</p>

<h2 id="target-audience-and-prerequisites"><strong>Target Audience and Prerequisites</strong></h2>

<p>This tutorial is aimed at an audience with intermediate experience in machine learning, data mining, or recommender systems who are interested in using OPE/OPL methods in their research and applications. 
Participants are expected to have basic knowledge of machine learning, probability theory, and statistics. 
Basic knowledge about causal inference might help understand the contents better, but is not required.</p>

<h2 id="outline"><strong>Outline</strong></h2>

<table>
  <thead>
    <tr>
      <th><strong>Sections</strong></th>
      <th><strong>Presenter</strong></th>
      <th><strong>Duration</strong></th>
      <th>Slides</th>
      <th>Code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>1: Introduction to OPE/OPL</strong></td>
      <td>Thorsten Joachims</td>
      <td>30min</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td><strong>2: Bias-Variance Control</strong></td>
      <td>Yuta Saito</td>
      <td>40min</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td><strong>3: Recent Advances in OPE</strong></td>
      <td>Yuta Saito</td>
      <td>40min</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td><strong>Break</strong></td>
      <td> </td>
      <td>30min</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td><strong>4: Off-Policy Learning</strong></td>
      <td>Thorsten Joachims</td>
      <td>40min</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td><strong>5: Implementations</strong></td>
      <td>Yuta Saito</td>
      <td>20min</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td><strong>6: Conclusions and QAs</strong></td>
      <td>Both</td>
      <td>10min</td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h2 id="section-abstracts"><strong>Section Abstracts</strong></h2>

<h3 id="1-introduction-to-opeopl-thorstem-joachims-30min">1. Introduction to OPE/OPL (Thorstem Joachims; 30min)</h3>

<p>We will introduce conventional formulation of OPE and how it helps improve interactive systems quickly and safely. We also introduce basic estimators in OPE including Direct Method (DM) and Inverse Propensity Score (IPS) weighting with some empirical illustrations to highlight their bias-variance trade-off.</p>

<h3 id="2-bias-variance-control-yuta-saito-40min">2. Bias-Variance Control (Yuta Saito; 40min)</h3>

<p>This section summarizes a wide range of existing estimators in OPE including Self-Normalized IPS, Doubly Robust, Switch, and Doubly Robust with Shrinkage. These estimators aim at achieving a better bais-variance trade-off compared to DM and IPS. We will provide comprehensive comparisons of these estimators from both theoretical and empirical perspectives.</p>

<h3 id="3-recent-advances-yuta-saito-40min">3. Recent Advances (Yuta Saito; 40min)</h3>

<p>This section will cover recent related methods to handle emerging practical challenges such as OPE of ranking policies, large-scale applications, deficient support, multiple loggers, and hyper-parameter tuning for OPE. These challenges are closely related to real-world applications such as recommender and retrieval systems where the estimators have to deal with many number of actions and non-stationary dynamics.</p>

<h3 id="4-off-policy-learning-thorsten-joachims-40min">4. Off-Policy Learning (Thorsten Joachims; 40min)</h3>

<p>This section will cover the fundamental methods for OPL where we aim at training a new decision-making policy using only the logged bandit data.</p>

<h3 id="5-implementations-yuta-saito-20min">5. Implementations (Yuta Saito; 20min)</h3>

<p>This section will introduce <a href="https://github.com/st-tech/zr-obp">Open Bandit Pipeline</a>, an open-source Python package for OPE/OPL, and demonstrate how it helps us implement OPE/OPL for both research and practical purposes.</p>

<h3 id="6-conclusions-and-qas-both-presenters-10min">6. Conclusions and QAs (Both Presenters; 10min)</h3>

<p>This section will conclude the tutorial by summarizing the previous sections and presenting remaining research challenges of the area. There will also be a live QA session.</p>

<h2 id="presenters">Presenters</h2>

<h3 id="yuta-saito-ys552cornelledu"><a href="https://usait0.com/en/">Yuta Saito</a> (ys552@cornell.edu)</h3>

<p>He is a Ph.D. student in the Department of Computer Science at Cornell University, advised by Prof. Thorsten Joachims. 
His current research focuses on OPE of bandit algorithm, learning from human behavior data, and fairness in ranking. 
Some of his recent work has been published at top conferences, including ICML, NeurIPS, SIGIR, RecSys, and WSDM. 
He has won the Best Paper Runner-Up Award at WSDM2020 and co-lectured a tutorial related to counterfactual inference at RecSys 2021.</p>

<h3 id="throsten-joachims-tjcscornelledu"><a href="https://www.cs.cornell.edu/people/tj/">Throsten Joachims</a> (tj@cs.cornell.edu)</h3>

<p>He is a Professor in the Department of Computer Science and in the Department of Information Science at Cornell University, and he is an Amazon Scholar. 
His research interests center on the synthesis of theory and system building in machine learning, with applications in information retrieval and recommendation. 
His past research focused on support vector machines, learning to rank, learning with preferences, and learning from implicit feedback, text classification, and structured output prediction. 
Working with his students and collaborators, his papers won 9 Best Paper Awards and 4 Test-of-Time Awards. He is also an ACM Fellow, AAAI Fellow, KDD Innovations Award recipient, and member of the SIGIR Academy.</p>

<h2 id="related-tutorials">Related Tutorials</h2>

<ul>
  <li><a href="https://www.cs.cornell.edu/~adith/CfactSIGIR2016/">Tutorial on Counterfactual Evaluation and Learning for Search, Recommendation and Ad Placement</a> (SIGIR2016)</li>
  <li><a href="https://ilps.github.io/webconf2020-tutorial-unbiased-ltr/">Unbiased Learning-to-Rank Counterfactual and Online Approaches</a> (SIGIR2019, WWW2020)</li>
  <li><a href="https://hunch.net/~rwil/">Tutorial on Real-World Interactive Learning</a> (ICML2017)</li>
  <li><a href="https://sites.google.com/view/kdd20-marketplace-autorecsys/">Tutorial on Advances in Recommender Systems: From Multi-stakeholder Marketplaces to Automated RecSys</a> (KDD2020)</li>
  <li><a href="https://causal-machine-learning.github.io/kdd2021-tutorial/">Causal Inference and Machine Learning in Practice with EconML and CausalML</a> (KDD2021)</li>
  <li><a href="https://sites.google.com/view/recsys-as-decision-theory">Recommender Systems through the Lens of Decision Theory</a> (WebConf2021)</li>
  <li><a href="https://sites.google.com/cornell.edu/recsys2021tutorial/home?authuser=0">Counterfactual Learning and Evaluation for Recommender Systems</a> (RecSys2021)</li>
</ul>

<h2 id="references"><strong>References</strong></h2>

<ol>
  <li>Aman Agarwal, Soumya Basu, Tobias Schnabel, and Thorsten Joachims. 2017. Effective Evaluation using Logged Bandit Feedback from Multiple Loggers. In Proceedings of the 23rd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, 687–696.</li>
  <li>Miroslav Dudík, Dumitru Erhan, John Langford, and Lihong Li. 2014. Doubly Robust Policy Evaluation and Optimization. Statist. Sci. 29, 4 (2014), 485–511.</li>
  <li>Mehrdad Farajtabar, Yinlam Chow, and Mohammad Ghavamzadeh. 2018. More Robust Doubly Robust Off-policy Evaluation. In Proceedings of the 35th International Conference on Machine Learning, Vol. 80. PMLR, 1447–1456.</li>
  <li>Nan Jiang and Lihong Li. 2016. Doubly Robust Off-Policy Value Evaluation for Reinforcement Learning. In Proceedings of the 33rd International Conference on Machine Learning, Vol. 48. PMLR, 652–661.</li>
  <li>Thorsten Joachims and Adith Swaminathan. 2016. Counterfactual Evaluation and Learning for Search, Recommendation and Ad Placement. In Proceedings of the 39th International ACM SIGIR conference on Research and Development in Information Retrieval, 1199–1201.</li>
  <li>Nathan Kallus, Yuta Saito, and Masatoshi Uehara. 2021. Optimal Off-Policy Evaluation from Multiple Logging Policies. In Proceedings of the 38th International Conference on Machine Learning, Vol. 139. PMLR, 5247–5256.</li>
  <li>Nathan Kallus and Angela Zhou. 2018. Policy Evaluation and Optimization with Continuous Treatments. In Proceedings of the Twenty-First International Conference on Artificial Intelligence and Statistics. PMLR, 1243–1251.</li>
  <li>Masahiro Kato, Shota Yasui, and Masatoshi Uehara. 2020. Off-Policy Evaluation and Learning for External Validity under a Covariate Shift. In Advances in Neural Information Processing Systems, Vol. 33. 49–61.</li>
  <li>Shuai Li, Yasin Abbasi-Yadkori, Branislav Kveton, S Muthukrishnan, Vishwa Vinay, and Zheng Wen. 2018. Offline Evaluation of Ranking Policies with Click Models. In Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining, 1685–1694.</li>
  <li>James McInerney, Brian Brost, Praveen Chandar, Rishabh Mehrotra, and Benjamin Carterette. 2020. Counterfactual Evaluation of Slate Recommendations with Sequential Reward Interactions. In Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining. 1779–1788.</li>
  <li>Noveen Sachdeva, Yi Su, and Thorsten Joachims. 2020. Off-policy Bandits with Deficient Support. In Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining. 965–975.</li>
  <li>Yuta Saito, Shunsuke Aihara, Megumi Matsutani, and Yusuke Narita. 2020. Open Bandit Dataset and Pipeline: Towards Realistic and Reproducible Off-Policy Evaluation. arXiv preprint arXiv:2008.07146 (2020).</li>
  <li>Ashudeep Singh and Thorsten Joachims. 2018. Fairness of Exposure in Rankings. In Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining. 2219–2228.</li>
  <li>Ashudeep Singh and Thorsten Joachims. 2019. Policy Learning for Fairness in Ranking. In Advances in Neural Information Processing Systems, Vol. 32.</li>
  <li>Yi Su, Maria Dimakopoulou, Akshay Krishnamurthy, and Miroslav Dudík. 2020. Doubly Robust Off-Policy Evaluation with Shrinkage. In Proceedings of the 37th International Conference on Machine Learning, Vol. 119. PMLR, 9167–9176.</li>
  <li>Yi Su, Lequn Wang, Michele Santacatterina, and Thorsten Joachims. 2019. Cab: Continuous Adaptive Blending for Policy Evaluation and Learning. In Proceedings of the 36th International Conference on Machine Learning, Vol. 97. PMLR, 6005–6014.</li>
  <li>Adith Swaminathan and Thorsten Joachims. 2015. Batch Learning from Logged Bandit Feedback through Counterfactual Risk Minimization. The Journal of Machine Learning Research 16, 1 (2015), 1731–1755.</li>
  <li>Yu-Xiang Wang, Alekh Agarwal, and Miroslav Dudık. 2017. Optimal and Adaptive Off-Policy Evaluation in Contextual Bandits. In Proceedings of the 34th International Conference on Machine Learning, Vol. 70. PMLR, 3589–3597.</li>
  <li>Yusuke Narita, Shota Yasui, Kohei Yata. 2021. Debiased Off-Policy Evaluation for Recommendation Systems.  In Fifteenth ACM Conference on Recommender Systems. Association for Computing Machinery, xxx.</li>
  <li>Nathan Kallus and Masatoshi Uehara. 2020. Double Reinforcement Learning for Efficient and Robust Off-Policy Evaluation. In Proceedings of the 37th International Conference on Machine Learning, Vol. 119. PMLR, 5078-5088.</li>
  <li>Adith Swaminathan and Thorsten Joachims. 2016. The Self-Normalized Estimator for Counterfactual Learning. In Advances in Neural Information Processing Systems, Vol. 28.</li>
  <li>Minmin Chen, Alex Beutel, Paul Covington, Sagar Jain, Francois Belletti, Ed Chi. 2019. Top-K Off-Policy Correction for a REINFORCE Recommender System. In Proceedings of the Twelfth ACM International Conference on Web Search and Data Mining, 456-464.</li>
  <li>Sergey Levine, Aviral Kumar, George Tucker, Justin Fu. 2020. Offline Reinforcement Learning: Tutorial, Review, and Perspectives on Open Problems. arXiv preprint arXiv:2005.01643 (2020).</li>
  <li>Yuta Saito and Thorsten Joachims. 2022. Off-Policy Evaluation for Large Action Spaces via Embeddings. arXiv preprint arXiv:2202.06317 (2022).</li>
  <li>Yuta Saito, Takuma Udagawa, Haruka Kiyohara, Kazuki Mogi, Yusuke Narita, and Kei Tateno. 2021. Evaluating the Robustness of Off-Policy Evaluation. In Fifteenth ACM Conference on Recommender Systems. 114–123.</li>
  <li>Haruka Kiyohara, Yuta Saito, Tatsuya Matsuhiro, Yusuke Narita, Nobuyuki Shimizu, and Yasuo Yamamoto. 2022. Doubly Robust Off-Policy Evaluation for Ranking Policies under the Cascade Behavior Model. In Proceedings of the Fifteenth ACM International Conference on Web Search and Data Mining. 487–497.</li>
  <li>Yi Su, Pavithra Srinath, and Akshay Krishnamurthy. 2020. Adaptive Estimator Selection for Off-Policy Evaluation. 2020. In Proceedings of the 37th International Conference on Machine Learning, pp. 9196–9205.</li>
  <li>Alberto Maria Metelli, Alessio Russo, and Marcello Restelli. 2021. Subgaussian and Differentiable Importance Sampling for Off-Policy Evaluation and Learning. In Advances in Neural Information Processing Systems, Vol. 33.</li>
</ol>



  

  <!-- Hide posts if front matter flag hide:true -->
  
  

  <!-- Sort posts by rank, then date -->
  
  
  

 
  

   <!-- Assemble final sorted posts array -->
  
  <ul class="post-list"><li><h3>
    <a class="post-link" href="/kdd2022-tutorial/jupyter/2020/02/20/test.html">
    Fastpages Notebook Blog Post
    </a>
</h3><p class="post-meta-description">A tutorial of fastpages for Jupyter notebooks.</p><p class="post-meta">Feb 20, 2020</p>
</li></ul>

    </div>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/kdd2022-tutorial/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/kdd2022-tutorial/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/kdd2022-tutorial/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Counterfactual Evaluation and Learning for Interactive Systems (KDD2022 Tutorial)</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/counterfactual-ml" target="_blank" title="counterfactual-ml"><svg class="svg-icon grey"><use xlink:href="/kdd2022-tutorial/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/usait0" target="_blank" title="usait0"><svg class="svg-icon grey"><use xlink:href="/kdd2022-tutorial/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
